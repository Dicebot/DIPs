# Unleash the traits

| Field           | Value                                                           |
|-----------------|-----------------------------------------------------------------|
| DIP:            | 8484                                                            |
| Author:         | Basile Burg                                                     |
| Implementation: |                                                                 |
| Status:         | Draft                                                           |

## Abstract

The results of `__traits()` are limited by the protection attributes.

This DIP proposes to remove the limitation to the all the traits and to add a new a new trait, similar to `allMembers` that will respect the visibility.

### Links

- https://forum.dlang.org/thread/nq512d$9po$1@digitalmars.com
- https://issues.dlang.org/show_bug.cgi?id=15335
- https://issues.dlang.org/show_bug.cgi?id=15371

## Description

### New trait

The trait `allVisibleMembers` will behave exactly as `allMembers` except that the protection attributes will be respected. Since the results of `allMembers` are often used as source in the other traits, `allVisibleMembers` will prevent to pass 
inaccessible member.

It's also worth mentioning that `getProtection` can be used to stay compliant with the protection attributes.

### Changes applied to the existing traits

- `allMembers`: see all.
- `getMember`: see all.
- `getOverloads`: see all.
- `derivedMembers`: see all.
- (TODO: complete the list)

It doesn't matter if they see everything, as mentioned previously `allVisibleMembers` acts as a filter.

### Rationale

#### History of protection attributes

Protection attributes such as `private` and `public` appeared with the Object Oriented Programming paradigm (added to Simula in 1987). Applied to the traits, they limit the creativity since D is a multi paradigm language. Meta programming is particularly affected by the limitation.

#### Library traits

The problem was [detected for the first time](https://issues.dlang.org/show_bug.cgi?id=15335) shortly after the phobos additions `hasUDA` `getUDAs` and `getSymbolsByUDA`.
The languages traits could be used to implement easily more library traits. However the protection attributes would make them unusable in many scenario.

### Breaking changes / deprecation process

Any usage of `allMembers` will have to be replaced by `allVisibleMembers`.

### Examples

```D
module thing;

struct A
{
   private int _field;
   int value;
}
```

```D
module stuff;

import std.stdio, thing;

void unleashed()
{
   foreach(member; __traits(allMembers, thing.A))
      write(member, " "); // _field value
}

void protectionCompliant()
{
   foreach(member; __traits(allVisibleMembers, thing.A))
      write(member, " "); // value
}

```


## Copyright & License

Copyright (c) 2016 by the D Language Foundation

Licensed under [Creative Commons Zero 1.0](https://creativecommons.org/publicdomain/zero/1.0/legalcode.txt)

### Reviews
